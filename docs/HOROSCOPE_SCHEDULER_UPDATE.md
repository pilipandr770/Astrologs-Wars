# Настройка автоматического запуска гороскопов

## Обновление расписания

В рамках последнего обновления изменено время автоматической генерации гороскопов:

- **Render.yaml**: время выполнения задачи изменено с 00:00 на 03:00
- **Локальный шедулер**: время выполнения изменено с 07:00 на 03:00

## Настройка на Render

### В render.yaml

```yaml
- type: cron
  name: astrolog-horoscope-generator
  runtime: python
  region: frankfurt
  schedule: "0 3 * * *"  # Run once a day at 3:00 AM
```

Эта настройка гарантирует, что cron-задание будет запускаться каждый день в 3:00 утра по серверному времени (Frankfurt).

## Локальный запуск шедулера

Для локального запуска используются скрипты:

- Windows: `run_horoscope_scheduler.bat`
- Linux/Mac: `run_horoscope_scheduler.sh`
- PowerShell: `run_horoscope_scheduler.ps1`

Шедулер будет работать в фоновом режиме и запускать генерацию гороскопов каждый день в 3:00 по локальному времени.

## Ручной запуск генерации

Если необходимо запустить генерацию гороскопов немедленно, используйте:

```bash
python daily_horoscope_replace.py
```

## Интеграция с эфемеридами

В новой версии шедулера добавлена возможность использования астрономических данных (эфемерид) для более точной генерации гороскопов. Данные автоматически добавляются в запросы к ассистентам OpenAI, если доступен модуль `ephemeris`.

## Мониторинг работы шедулера

Логи работы шедулера сохраняются в `horoscope_scheduler.log`.

Для проверки статуса на сервере:

```bash
# Проверка статуса сервиса (если используется systemd)
sudo systemctl status horoscope-scheduler

# Просмотр логов
tail -f horoscope_scheduler.log
```
